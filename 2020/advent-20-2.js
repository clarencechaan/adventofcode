let input = `Tile 2141:
#.#...#...
###..#...#
.....##...
..#.##..#.
.#....#..#
...#######
.....#...#
#.#......#
##........
########.#

Tile 3467:
..#.#....#
#.....#..#
....#....#
...#......
#.#....###
.#....#..#
#.........
.....#...#
.##...#...
##.#..#.#.

Tile 3389:
......##..
.##...#...
.#..###...
....##.#..
#..#.#....
.#.##..#..
#....##...
.#...#..##
..##.#...#
####..#..#

Tile 2797:
#..###..##
#.........
#.........
##.#....#.
.........#
.#...#...#
.........#
..#.#....#
..#...##..
...##..##.

Tile 1321:
.#....#..#
......#..#
#.#......#
#..#.#...#
.........#
.#..##....
...#.....#
#....#..#.
..##.##...
##.###.###

Tile 2741:
..#.#.####
#......##.
#.#...#.##
.##......#
..#.#....#
.#.#.....#
#........#
..#......#
#...#....#
...#..#..#

Tile 3169:
.##.#.#...
#.#..#...#
#...###...
..#...##..
.#..#.#.##
..#.......
...#......
.......#..
#.#.......
#.#.##..##

Tile 1097:
.##.#..#..
..#...##..
###.#.#...
..#..##...
......##.#
...#..#..#
#.#..#..##
.##.#...#.
##.#..#...
##..#...##

Tile 3457:
#.#.#.####
..#.#.#...
..#.......
##.....#..
#........#
.......#.#
#........#
#.......##
#..#.#..##
.##.##.#..

Tile 1471:
##.#.#.##.
..........
...#...#.#
#...#...#.
.....#..##
.......#.#
........##
...#...#.#
.#....####
.#.##.##.#

Tile 1531:
#....#..#.
#.#....#..
.......#..
.##.####.#
#..#.##..#
#........#
##.#.#...#
#...#....#
..........
...##..###

Tile 1523:
##..##.##.
...#..##..
#....#.#..
....#.####
#.#....#.#
....##..#.
#..#....#.
#..#..##.#
..#...##..
.#..####..

Tile 1447:
.#..#...##
.........#
..........
#.#....#.#
..#....##.
#......#.#
#.....#..#
#......#.#
..........
######....

Tile 2179:
#..#...#.#
..#......#
........#.
#.....#..#
......##..
#..#.##..#
#.##..#.#.
###.#..##.
...#..#..#
#.##..#.#.

Tile 1789:
#.#.#.##.#
#..#.#....
.#.#......
#.#....#..
##..#...#.
##..#....#
#.###.....
#..#.#.#..
#.......#.
#.##..####

Tile 2521:
.###..##..
..#.##....
##.#.....#
..##...#.#
#.###.#..#
.........#
.........#
#.........
.....#.#.#
.#....#.#.

Tile 3583:
..#..#.#..
..#.....##
#......#..
.........#
#...##.#.#
..#..#....
....#....#
#..#..#..#
#..#..###.
##...#.#.#

Tile 2633:
..#..#...#
..........
#..###..##
###......#
..#...#..#
#.###..###
##..#.##..
###.#.#..#
#....#....
#.#.######

Tile 1667:
###.##..#.
........#.
..#...##.#
........#.
#..##....#
#.#..#..##
.##......#
..#.......
#..#..#..#
.###..##.#

Tile 2003:
......#...
#.#.......
#..#......
#.....#..#
##.......#
.....##.##
#.###.....
#..#.#...#
......#...
#.##...#..

Tile 1103:
###.######
...######.
........#.
#....##..#
#.....#..#
#....#....
#..##..#.#
...##....#
#......#..
##...#.#.#

Tile 3167:
..##...##.
##.......#
...#...#.#
.......#..
.........#
........#.
##.......#
##.#.....#
..#.#.....
.#.####.##

Tile 1031:
#.##....##
#.#..#...#
#...#.....
#.#.......
#.#..##...
#...#....#
##..#....#
.#.#.....#
#.......##
...#####.#

Tile 2539:
##...#..##
..#....#..
......#..#
#...###..#
...#...#..
##....####
#.......##
#......#.#
.........#
.##.#..###

Tile 1871:
.#..#.#.##
...###...#
.........#
#...##....
...###...#
###.#..#.#
#..##....#
##.....#..
#....#..##
#####.##..

Tile 2383:
.#.....###
#.#.......
#.....#..#
.#...##..#
...#...#.#
#....#.#.#
...#....##
##.#..####
...#.....#
###.##.#..

Tile 1237:
##.#.#.##.
.##...####
#...#..#..
##.#..#.#.
##....#.#.
....#..###
....#....#
#.......##
..##...#.#
#.#..#..##

Tile 1093:
..##.###..
....###...
#..#.#....
#.........
..........
..#....#.#
#.....#...
........#.
......##.#
.#...#..##

Tile 1583:
..###.#..#
.........#
......##..
#....#..##
.###...###
..##..#.#.
....##.#.#
#.....#.#.
##.......#
#.#.##..#.

Tile 2243:
..#..#####
...#....##
#.....#..#
#......#.#
..#.#..#.#
.#...#...#
##.....#..
##.##.###.
#........#
#..#...#.#

Tile 1297:
..#......#
##..#.....
.##.#.....
.....##..#
.#....##..
#.#.#...##
.#........
.##.##.#.#
..#.###..#
#..#...#..

Tile 1877:
....###.#.
#....#....
.##...#..#
.........#
.........#
.#..##.#..
...#.....#
#.....#..#
...##.....
#.#.#.#...

Tile 3779:
.#...##..#
.#.......#
#.........
#.......##
.....#...#
.........#
...#.#...#
#.........
..#..#.###
#.#####.#.

Tile 2029:
....##..##
#..###...#
.....#..##
#...#.#...
##..###..#
#.#..##.#.
.......#.#
..##..#..#
..#....#.#
.##..#####

Tile 3221:
.#..#..##.
.###..#...
....#.##..
#.#.#.#.#.
#..#...#..
..........
#.#.....##
###....#.#
..###...#.
#......#..

Tile 3463:
.#.#......
#...#..#..
......#..#
#..#.##..#
#.....#..#
.#..###.#.
#####...#.
#.#....#..
#.........
##.###.#.#

Tile 3331:
##.###..##
##..#..#..
.....##...
..#...#.#.
#..#.#...#
...###....
.........#
.###....##
#...####.#
..#.##....

Tile 2473:
..####.#.#
##.#....##
......#.##
##.......#
##...##..#
##....#..#
.#.#.#....
......##.#
..#.##....
#..###...#

Tile 2459:
##.##....#
..........
#.#....###
#.........
##....##.#
...#......
###.......
..........
#.....#...
.#.###.#.#

Tile 3877:
...#.#.#..
#....#...#
.#......#.
......##.#
....#.##.#
.#.#..#.##
##........
....#.####
###...#.##
######..##

Tile 2161:
..##...#..
#....#...#
#.#.#.#..#
.##....###
...#..#...
#.........
.##....##.
.........#
#........#
.#.#.###..

Tile 3361:
#..##.....
.##.....#.
#........#
#..#......
#.........
##...##..#
..#..#....
#.#.......
...#.....#
###.#.##..

Tile 2089:
.##.####.#
...#....##
.###.#.#..
.........#
..#.##..#.
.###..##..
..........
...##.#..#
#..#....##
#...####.#

Tile 2711:
.##.#..###
#.#.....##
#..###.#.#
.##.....##
...#....#.
##......#.
#........#
..#.......
###..#.#.#
...#.##..#

Tile 1753:
....##.###
#........#
#...#...#.
..##.#....
#..#..#.##
#.....#..#
#.........
...#......
##.....#..
##..#.....

Tile 2953:
.#.####..#
...#.....#
.##.....##
#...#.....
##........
###.#..#.#
#..#.##...
#..#...#..
#.#......#
..#.#...#.

Tile 3593:
#..#.#..#.
#.#.....#.
#.#.......
#..#.....#
...#..#...
#........#
#....#.#.#
#..#......
..#......#
...#..#.##

Tile 1483:
..#.####..
.#.......#
##........
.......#..
##..#....#
#........#
..#...#...
#.........
###....#..
..#.#..##.

Tile 1657:
#####..##.
.###....#.
...#...#.#
#..#....#.
#.#...#.#.
.....##.##
.......#.#
####......
#..##....#
..#...#..#

Tile 3307:
.#..##.###
....#..#..
###..#..##
#.###.....
..###....#
#..#...#.#
.........#
....#.###.
..#......#
#.##.#.###

Tile 3617:
...#.#.#..
..........
.#....#.##
.#.#...#..
.#.....#..
.##.#..###
#..#......
#......#..
.#..#...#.
#.##..#..#

Tile 3001:
##...#####
..##.....#
#.....#.##
##........
....#.....
#....#..#.
...##.#...
.......#.#
#.....#..#
#.####....

Tile 1013:
.##..#....
#....##...
#...#...##
.#.###...#
....#..#..
##...#..#.
..#....#..
#...#..#.#
...#.....#
####.#####

Tile 2801:
#...##.##.
#.....#...
......#...
#....#...#
...##.....
.#......#.
....##..##
#....#####
....##...#
..#..###..

Tile 3079:
..##.#...#
#.....#...
...#.....#
..#..#...#
#..#...###
#.##......
#.###.....
#........#
#.....#.#.
..#.#...#.

Tile 1231:
####.#####
..#.#....#
.#....#...
.#..#....#
..#......#
#..#.###.#
.#.......#
#.##...#.#
.....#.###
.###.###.#

Tile 1171:
..#..#..##
#...#....#
#....#...#
#.........
###......#
#...#..#..
..#..#.#..
...#...#..
.....#....
###..#.###

Tile 3319:
###.#####.
..........
..##......
#.......#.
#..#.#..#.
.#.##.....
..###..#.#
#...#...##
##.#.#....
...##...##

Tile 2129:
##...#.###
#........#
.....#...#
##.......#
#.#.#.#...
......#...
#....#..#.
..........
.......#.#
.###.###.#

Tile 3371:
.##.......
#....#.#.#
..#.#...##
#.........
.#.....#..
#.....#.##
...#......
##....#...
..#..##..#
#..#.#####

Tile 1129:
#.##..#.#.
#......###
#.#....#..
.####...##
#...#..#.#
#..#......
.##.....##
#..#.....#
..........
#.###..#..

Tile 1399:
#.....#.##
#........#
.....##...
........##
...#...#..
#.###..##.
#..#.#.#.#
....##.#.#
#.##.....#
.#..###.##

Tile 2503:
#...#...##
#..#.#....
.....#.#.#
...#.....#
..#......#
..##.....#
.....#....
...#...#.#
.#........
#.###...#.

Tile 3529:
.##...####
.#.....###
#..#..##..
....##.#.#
.......##.
#........#
.........#
#.##......
##....#..#
....#.##.#

Tile 1181:
.#.##.#.##
#..#......
#........#
..##......
##.#...#.#
.#.##..#.#
##........
#..#..#..#
#.#...#..#
..#.#.##..

Tile 1759:
...#..#..#
..#...#...
##....#...
#.#..#.#..
#.......##
#...#...##
##......#.
##...#.###
##...#....
.##...#...

Tile 2543:
######.###
####....##
##.#..#.#.
##...#....
..........
..#......#
#.......##
##........
..###..##.
##....####

Tile 3613:
.##..#....
......#..#
#.........
....##...#
....#....#
.#..#.....
....##...#
#.#..#..#.
#..#.....#
##.##...##

Tile 3853:
....######
.####....#
..###.....
#.#.......
#..#..#...
....#...##
##....##.#
#..##..#..
#.#..#...#
..#######.

Tile 3187:
.#..#.####
#.##....#.
.....#....
##....#...
.#.##.#...
#...##...#
#....#...#
......#...
#....#..#.
#..###....

Tile 2437:
#..#.##.#.
##...###.#
.....#....
.#......#.
...##.#...
#..###...#
#....#....
.#....#..#
..........
.##.#.#..#

Tile 2917:
#.....#...
.#.#...#..
#.##.##..#
......#..#
...###....
##.#......
....#....#
###.....##
.#.#....##
####.#..##

Tile 1511:
#...###.#.
..##.#..##
..#...#...
##.#..#.##
##....#..#
#.........
#........#
........#.
#.....##.#
.#.....##.

Tile 2699:
.#.#......
#........#
..##...#..
......##..
..##..#..#
#.###..#.#
#.#..#...#
#.##.....#
..###.....
###..##.##

Tile 3259:
###.###..#
.........#
#.#.....#.
...#..#...
.##....###
##.......#
...#.#...#
...##...##
#.........
......#...

Tile 1429:
....##.##.
.###...#..
##.#...###
#.........
#....#...#
#.....#...
...#.##...
#.......##
.#......##
###.#.##..

Tile 2039:
#....###.#
.#..#.#..#
#.#.#...#.
..#.......
##...#..##
#.#.......
#......##.
..#....#.#
#.#.......
..####.#..

Tile 3637:
#.###.#.##
#......###
#.........
.....#...#
..#..#.##.
#..#....#.
........#.
..#.......
...#......
...#.###.#

Tile 1163:
##.###.##.
#.##.#....
..#.#.....
#..####.#.
#..#......
#......#.#
.#........
.#.##.....
#.##....##
##.#......

Tile 3761:
...##.###.
.........#
....#.....
##.......#
#.......#.
...##.....
#.#.......
.........#
#.#......#
.##.###...

Tile 1777:
##...##.##
....#.....
.#...#....
#....#.#.#
..#.#....#
#....###.#
##...#....
#...###..#
#...##..#.
......#.##

Tile 2857:
.#..#.##..
#..#.....#
##........
...#.#..#.
.##..#..#.
#####.##.#
#..##.....
##...#.#.#
#...#.....
...##.##.#

Tile 3061:
.#.#.###.#
#........#
.###.###..
..##.....#
#...#....#
#.#.#..###
.##......#
.....##...
....#.....
.#..#..#..

Tile 1721:
..#..#####
.#....###.
#..#...#..
#.........
#....#...#
...##..##.
#........#
#......#..
#.........
....##.###

Tile 2693:
.....#.#..
.#......#.
.#.....#.#
#....##..#
#..#......
####.##..#
#.#.....#.
..........
#.#....#.#
#.##..#...

Tile 1259:
#...#..###
#...#...##
##..#.#..#
#.#.......
#......#.#
###.......
#...#.....
...#.....#
.#...#...#
.#...##.##

Tile 1291:
#..##.#...
#.....##.#
.#..#....#
#...#...#.
..###.#...
###......#
#..#...#.#
#....#....
..##......
#..#..#.#.

Tile 1051:
#...####.#
##..#.....
.........#
.#..#..#..
##...#..##
...##....#
##........
.#......#.
...#.....#
###.###..#

Tile 2719:
.#.##..##.
.#.....#..
#.....#...
##.#.....#
#######...
##...##.#.
......##..
........##
..#....###
#..#..#.##

Tile 3533:
...##....#
##.......#
#....#....
....##...#
.....##.##
....#..##.
#.........
###...#.#.
#.........
#..####...

Tile 2659:
.##.#...#.
.#..#...#.
....#...##
.#..#.#..#
#.##.##..#
..##.....#
..#..#..##
..#.......
.........#
#....####.

Tile 3517:
#..##.#.#.
.#...#...#
.#.#.....#
##.......#
..#.......
#......#..
.........#
...##...#.
......#.##
..##...#..

Tile 2371:
###.##.##.
.#.#.##..#
.....#...#
#.#.#..#.#
####...#.#
#.#.#.##..
..#.#.....
##........
..#..#...#
#...#.###.

Tile 1601:
.####..##.
#.........
......#...
#.#..##.#.
..##.#.#.#
#.......#.
#..#.....#
#.....#.#.
..###....#
.#..######

Tile 2273:
..###.###.
....#.....
.##...#...
#.#...#...
....#.....
.#.....#.#
.#......#.
.#.#..#...
........##
##..###...

Tile 3917:
####.#...#
#...#...##
#.##...###
#..#...##.
....#....#
.........#
......#..#
###.#.#...
...##...##
#..#####.#

Tile 3701:
#..###...#
###..#...#
#.#...##.#
.##.#.#..#
.##..#..##
##..#.#...
.##.#.#.##
....##.#..
#.....#...
..##.##.#.

Tile 2081:
...####.#.
........##
#.#...#..#
.###...##.
#..#.##...
#....#....
#.#..###..
........##
..#......#
...##..###

Tile 2339:
#.#..#..##
.#..#...#.
........##
.##....#..
#.....#.#.
........#.
....#...##
.#....##..
#........#
#.##.#...#

Tile 1373:
###.###...
.........#
#......###
#...##...#
.###....#.
#..#.....#
..........
##..#..#.#
.###.#..##
###...##..

Tile 2837:
##....#...
...#...#.#
#.........
..#.......
##.#......
.#....#...
.###....#.
##......##
.....#....
.#.##.....

Tile 3803:
#..#..##..
.......#..
##.###....
#.#.#.#...
....##....
#.###..#.#
....#...##
........#.
..##.....#
..#..###..

Tile 3559:
#....##.##
...##.....
..#..#...#
#........#
##........
#.#.......
#.#..#.#.#
#....#..#.
#...#.....
##.#.#....

Tile 1549:
####.##.#.
......#...
#..#.#..##
#..#..#.#.
.#.....#.#
.........#
.........#
#....#...#
#.......#.
#####....#

Tile 1699:
.#.##.#.#.
.#..####..
.#.#......
.###..##.#
#........#
##.#......
.#.#.##..#
#.#..#....
#.......#.
.###.##..#

Tile 2647:
###.......
.......#.#
..#.#...#.
#..#...#..
..##......
#.#.#....#
....#.#.#.
#.........
#...#.....
#.###...##

Tile 1361:
...##.#.#.
..........
#.........
#.#....#..
##..##...#
....#.....
#.......#.
..........
#.##.#.#..
#..##.#.##

Tile 3851:
##........
...##.#...
....#.....
....####..
#.....#..#
#...#.##.#
#..#.....#
...#..##.#
#.#....#..
#..####...

Tile 3911:
##..##.##.
#.#.....##
...#.#...#
.....#....
.#...#..#.
...##.##..
#.#.#.####
.......#.#
...#.#....
##..#.##.#

Tile 3719:
##.##.###.
....#..#..
...#......
#......###
.#.#....##
..###...#.
....#..#.#
..........
#..#....#.
#####..###

Tile 2239:
###.##.##.
###......#
#.##.#..#.
..#....#..
......##..
.....#..#.
...#......
#.........
..........
.#.....###

Tile 1249:
#.#..####.
...#.....#
....#....#
.........#
.#.##...##
..#.####.#
...###....
#.........
#.....#...
.#..#.#...

Tile 2707:
.##.#.....
#.....##.#
.#..#...##
...#.#.#..
..#.......
.#.#...#..
#.....#...
#.##......
.#........
.###.#..##

Tile 2897:
..###...#.
...#..#..#
#......#..
#..#.....#
.....#....
..##..####
#...##...#
#.#......#
##......##
......#..#

Tile 3623:
#..#.....#
##.#...##.
##.......#
#.#....#.#
.#....#..#
#.##..#...
.##....#.#
.#.......#
#.#.#..#.#
#..#.###.#

Tile 2617:
.######...
#..#.....#
..........
#####....#
....#....#
##.###..##
......##..
.....##..#
#.........
...####.#.

Tile 1049:
..#.##...#
.#.....#.#
......#..#
#####.#...
......#...
....#.....
#.........
#.........
##.......#
..#..#.#.#

Tile 3019:
##.##..#..
##...#..##
...#....#.
..........
...#......
#...#...#.
####.##.#.
###......#
.....#....
######...#

Tile 3067:
#...#.#..#
#.#.##...#
....#.#..#
##.#......
....###..#
.#.....#..
.#.......#
......#..#
##.#.....#
.#####.###

Tile 3203:
#...###.##
#.#......#
..#..#..#.
.##...##.#
#.....###.
...##....#
#......#.#
.#........
.#.#....##
##.#####.#

Tile 2113:
.#.#.#..#.
#...#.....
###.....##
#.###.....
##........
#...##....
......####
......#..#
#..###.##.
..#.###.##

Tile 2591:
##..###...
........##
#........#
.....##..#
.........#
..#...#...
....#..#.#
#......#..
...#......
.##.##.#.#

Tile 1499:
.....##..#
...#......
.##.....#.
......##.#
.#........
#..##.#...
....##...#
#........#
....#.....
.#.##.#..#

Tile 3413:
#..#..##..
.#..#..###
#..#....##
##.......#
#.###.....
#....#..##
#........#
.....#...#
#...#....#
#.#..#..#.

Tile 3923:
.#...#####
#..####...
#.##....#.
#....##..#
#.#...##.#
..#..#....
#.#......#
.#..#..#.#
#.##....#.
###.###...

Tile 3527:
#.##...###
#......##.
#..#..#..#
....#....#
#.....#.##
..........
#........#
#..#.#...#
.##..#...#
#.#.##.###

Tile 2957:
###.#...#.
#.#..#....
...#.....#
#.#......#
.##.....#.
.........#
....#.....
#......#.#
...#......
#..##.##..

Tile 1481:
##....#...
...#...#.#
#.##......
.......#..
.#..#..#.#
.....###.#
#.........
.......##.
......#...
..###....#

Tile 1747:
###..#####
..#.##....
##.......#
.#........
#.##.....#
...#......
#........#
#.##...#.#
####......
##.##...#.

Tile 3659:
.##.###...
##..##.##.
####..#.##
....##.###
#.........
.##.#.#..#
.#...#..##
..####.##.
#..#..#...
..###...#.

Tile 2621:
#####....#
...#....#.
.##......#
..###....#
...#..#...
.........#
#.........
.#..#..#..
.#...##...
#......#.#

Tile 2927:
.#..####..
......#.##
.......#.#
#...#.##.#
##...#..##
#.....##.#
#.......#.
##........
#.....#...
##.#.##...

Tile 3727:
..#.....#.
#........#
####..#..#
##.#....##
...#......
###....#..
#..##..#.#
#.#.#...##
#...#.....
.####.##.#

Tile 2803:
##.##..###
#....###.#
#.....##..
#.#...#...
.#.#......
#...##..##
......#...
##.....#.#
.##.#..##.
..##.##...

Tile 2593:
.##.#....#
#.#.#.#...
#.......##
..........
...####...
....##....
#...##.#.#
#...##..##
.##......#
##....##.#

Tile 3109:
.###.#..##
#.........
.#...#..##
##...#...#
#..#....#.
#.........
#........#
#.##..#...
.#.......#
#.#####..#

Tile 3797:
#...##.##.
.....#..#.
##..##.#..
#........#
.#...#....
##..#.#...
##....#...
###.##...#
#......#.#
##.###..#.

Tile 1367:
##.#..##.#
..#.......
.#.......#
...#..##..
.##....##.
#..#.##..#
..#...#..#
#.#......#
#..#....##
...##..#..

Tile 2309:
##.#.####.
..###.....
...#....##
..#....#..
.#....#..#
##....#..#
..#......#
..##..##.#
.....###.#
#..##.##.#

Tile 2087:
.#.#.#.#.#
#.##....#.
#..#....#.
...#......
#.......##
...#..#...
#...###..#
.#....#..#
.#.###...#
.#.#######

Tile 2441:
....####.#
.........#
#.....##..
.#..##.#.#
####.#..##
#.#.....#.
#.#.#.##.#
....#...##
###..###.#
.#.....##.

Tile 3643:
##.#...###
..##....##
.....#....
#.#.#.#...
...#.#.#..
....##....
....##....
#.....##.#
#.......##
.......##.

Tile 3251:
##...#.#..
.#.......#
.#....##..
..#.....##
.#.#......
..#..##.##
.##..###.#
....#....#
##..##...#
#.#..###.#

Tile 1787:
#.#.#..#.#
..........
..#......#
..........
.#......#.
..#....#..
........#.
##....#..#
..##......
###.#...#.`;

input = input
  .split("\n\n")
  .map((str) => str.split("\n"))
  .map((sqr) => ({
    id: parseInt(sqr[0].slice(-5, -1)),
    square: sqr.slice(1).map((str) => str.split("")),
  }));

const n = Math.sqrt(input.length);

function getRotatedSquare(sqr) {
  let result = [];
  for (let i = 0; i < sqr.length; i++) result.push([]);

  for (let i = 0; i < sqr.length; i++)
    for (let j = 0; j < sqr.length; j++)
      result[j][sqr.length - 1 - i] = sqr[i][j];

  return result;
}

function getFlippedSquare(sqr) {
  let result = [];
  for (let i = 0; i < sqr.length; i++) result.push([...sqr[i]].reverse());
  return result;
}

for (let i = 0; i < input.length; i++) {
  let top = input[i].square;
  input[i].orientations = [top];
  for (let j = 0; j < 7; j++) {
    if (j === 3) top = getFlippedSquare(top);
    else top = getRotatedSquare(top);
    input[i].orientations.push(top);
  }
}

function doBordersAlign(sqr1, borderID1, sqr2, borderID2) {
  let border1 = [];
  let border2 = [];

  switch (borderID1) {
    case 0:
      for (let i = 0; i < 10; i++) border1.push(sqr1[0][i]);
      break;
    case 1:
      for (let i = 0; i < 10; i++) border1.push(sqr1[i][9]);
      break;
    case 2:
      for (let i = 0; i < 10; i++) border1.push(sqr1[9][9 - i]);
      break;
    case 3:
      for (let i = 0; i < 10; i++) border1.push(sqr1[9 - i][0]);
      break;
  }

  switch (borderID2) {
    case 0:
      for (let i = 0; i < 10; i++) border2.push(sqr2[0][i]);
      break;
    case 1:
      for (let i = 0; i < 10; i++) border2.push(sqr2[i][9]);
      break;
    case 2:
      for (let i = 0; i < 10; i++) border2.push(sqr2[9][9 - i]);
      break;
    case 3:
      for (let i = 0; i < 10; i++) border2.push(sqr2[9 - i][0]);
      break;
  }

  for (let i = 0; i < 10; i++) if (border1[i] !== border2[9 - i]) return false;
  return true;
}

let arr = [];
for (let i = 0; i < n; i++) arr.push(Array(n).fill(null));

function findArrangement(arrangement = arr, used = new Set()) {
  if (used.size === input.length) return arrangement;
  const row = Math.floor(used.size / n);
  const col = used.size % n;
  for (let i = 0; i < input.length; i++) {
    if (used.has(i)) continue;
    used.add(i);
    for (const orientation of input[i].orientations) {
      if (
        row > 0 &&
        !doBordersAlign(orientation, 0, arrangement[row - 1][col][1], 2)
      )
        continue;
      if (
        col > 0 &&
        !doBordersAlign(orientation, 3, arrangement[row][col - 1][1], 1)
      )
        continue;
      arrangement[row][col] = [input[i].id, orientation];
      let result = findArrangement(arrangement, used);
      if (result) return result;
    }
    arrangement[row][col] = null;
    used.delete(i);
  }
}

findArrangement();
arr = arr.map((row) => row.map(([, square]) => square));
for (const row of arr)
  for (let i = 0; i < row.length; i++) {
    row[i] = row[i].slice(1);
    row[i].pop();
    for (let j = 0; j < row[i].length; j++) {
      row[i][j] = row[i][j].slice(1);
      row[i][j].pop();
    }
  }

let image = [];
for (let i = 0; i < n * 8; i++) image.push([]);
for (let i = 0; i < n; i++)
  for (let j = 0; j < n; j++)
    for (let k = 0; k < arr[i][j].length; k++)
      for (let l = 0; l < arr[i][j][k].length; l++)
        image[i * 8 + k][j * 8 + l] = arr[i][j][k][l];

function printSquare(sqr) {
  console.log(sqr.map((row) => row.join("")).join("\n"));
}

function countSeaMonsters(image) {
  let seaMonster = `                  # 
#    ##    ##    ###
 #  #  #  #  #  #   `;
  seaMonster = seaMonster.split("\n").map((str) => str.split(""));

  let smCoords = [];
  for (let i = 0; i < seaMonster.length; i++)
    for (let j = 0; j < seaMonster[i].length; j++)
      if (seaMonster[i][j] === "#") smCoords.push([j, i]);

  function doesSeaMonsterExist(row, col) {
    return smCoords.every(([x, y]) => image[row + y]?.[col + x] === "#");
  }

  let count = 0;
  for (let i = 0; i < image.length; i++)
    for (let j = 0; j < image[i].length; j++)
      if (doesSeaMonsterExist(i, j)) count++;

  return count;
}

for (let i = 0; i < 8; i++) {
  if (i === 4) image = getFlippedSquare(image);
  else image = getRotatedSquare(image);
  let numOfSeaMonsters = countSeaMonsters(image);
  if (numOfSeaMonsters) {
    let output =
      image.reduce(
        (sum, row) =>
          sum + row.reduce((sum, cell) => sum + (cell === "#" ? 1 : 0), 0),
        0
      ) -
      numOfSeaMonsters * 15;
    console.log(output);
    return;
  }
}
