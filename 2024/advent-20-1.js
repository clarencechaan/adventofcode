let input = `#############################################################################################################################################
#.............###.....#...#.........#...............#...#.......#...###.....#.....#...###...#...###.......###.....#.........................#
#.###########.###.###.#.#.#.#######.#.#############.#.#.#.#####.#.#.###.###.#.###.#.#.###.#.#.#.###.#####.###.###.#.#######################.#
#.......#...#...#...#...#.#.......#.#.......#.....#...#...#.....#.#...#...#.#...#.#.#.#...#...#...#.#.....#...#...#...#...#.............#...#
#######.#.#.###.###.#####.#######.#.#######.#.###.#########.#####.###.###.#.###.#.#.#.#.#########.#.#.#####.###.#####.#.#.#.###########.#.###
#...###...#...#.###.....#.........#.###...#...#...#.......#.#...#...#.#...#.....#...#.#.........#...#...###...#.....#.#.#...#...#...###.#...#
#.#.#########.#.#######.###########.###.#.#####.###.#####.#.#.#.###.#.#.#############.#########.#######.#####.#####.#.#.#####.#.#.#.###.###.#
#.#...###...#.#.......#...........#.#...#.....#...#.#...#...#.#...#.#.#.............#.#.....###.#.......#...#.#.....#.#.......#...#...#.....#
#.###.###.#.#.#######.###########.#.#.#######.###.#.#.#.#####.###.#.#.#############.#.#.###.###.#.#######.#.#.#.#####.###############.#######
#...#.....#.#.....#...#...........#.#...#...#...#.#...#...#...#...#.#.#...###.....#.#.#...#...#.#...#...#.#.#.#.#...#.#.....#...#...#.......#
###.#######.#####.#.###.###########.###.#.#.###.#.#######.#.###.###.#.#.#.###.###.#.#.###.###.#.###.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#######.#
###...#...#.....#.#.###...........#.###...#...#.#.#.......#...#.###.#.#.#...#.#...#.#.....#...#.#...#.#.#.#.#.#...#...#...#...#...#.........#
#####.#.#.#####.#.#.#############.#.#########.#.#.#.#########.#.###.#.#.###.#.#.###.#######.###.#.###.#.#.#.#.###########.###################
#...#...#...#...#.#.#...#.....#...#.#.........#...#.###.....#.#.#...#.#.#...#.#...#.......#.....#.....#...#...#...#.....#.........#.....#...#
#.#.#######.#.###.#.#.#.#.###.#.###.#.#############.###.###.#.#.#.###.#.#.###.###.#######.#####################.#.#.###.#########.#.###.#.#.#
#.#.#...#...#.....#.#.#.#...#.#...#.#.........#...#...#...#.#.#.#...#...#...#...#.###...#...#.............#...#.#.#...#.#.........#.#...#.#.#
#.#.#.#.#.#########.#.#.###.#.###.#.#########.#.#.###.###.#.#.#.###.#######.###.#.###.#.###.#.###########.#.#.#.#.###.#.#.#########.#.###.#.#
#.#...#.#...#.....#...#.....#.....#.#...#...#...#...#.#...#.#.#.#...#.......#...#...#.#.#...#.#...###...#...#.#.#.#...#...###...#...#...#.#.#
#.#####.###.#.###.#################.#.#.#.#.#######.#.#.###.#.#.#.###.#######.#####.#.#.#.###.#.#.###.#.#####.#.#.#.#########.#.#.#####.#.#.#
#.....#.###...###...#.............#...#.#.#.....###.#.#.#...#.#.#.#...###...#...#...#.#.#...#...#...#.#.....#.#.#...#####...#.#.#.#...#.#.#.#
#####.#.###########.#.###########.#####.#.#####.###.#.#.#.###.#.#.#.#####.#.###.#.###.#.###.#######.#.#####.#.#.#########.#.#.#.#.#.#.#.#.#.#
#...#.#.#.........#...#.........#.#...#.#.#.....#...#...#...#.#.#.#...#...#.#...#...#.#...#.#.......#.#.....#...#.....#...#.#.#.#.#.#...#.#.#
#.#.#.#.#.#######.#####.#######.#.#.#.#.#.#.#####.#########.#.#.#.###.#.###.#.#####.#.###.#.#.#######.#.#########.###.#.###.#.#.#.#.#####.#.#
#.#...#.#.......#.#...#.......#.#...#.#...#...#...#...#.....#.#.#...#.#...#...#.....#.#...#.#.#.....#.#.#...#...#...#.#...#...#.#.#...###.#.#
#.#####.#######.#.#.#.#######.#.#####.#######.#.###.#.#.#####.#.###.#.###.#####.#####.#.###.#.#.###.#.#.#.#.#.#.###.#.###.#####.#.###.###.#.#
#.....#.###.....#...#.#...#...#.#...#.....#...#.#...#...#...#.#.#...#.#...#.....#...#.#.....#.#...#.#.#.#.#.#.#.#...#.....#.....#...#.....#.#
#####.#.###.#########.#.#.#.###.#.#.#####.#.###.#.#######.#.#.#.#.###.#.###.#####.#.#.#######.###.#.#.#.#.#.#.#.#.#########.#######.#######.#
#.....#.#...#.......#.#.#...#...#.#.#.....#...#.#.#...#...#...#.#.#...#...#.....#.#.#.......#.....#...#.#.#.#.#.#.#.........###...#.#.......#
#.#####.#.###.#####.#.#.#####.###.#.#.#######.#.#.#.#.#.#######.#.#.#####.#####.#.#.#######.###########.#.#.#.#.#.#.###########.#.#.#.#######
#.....#.#.....#.....#...#...#.###.#.#.....#...#.#.#.#.#.......#.#.#.#...#...#...#.#.###...#...#.........#.#.#.#.#.#.#...###...#.#.#.#.......#
#####.#.#######.#########.#.#.###.#.#####.#.###.#.#.#.#######.#.#.#.#.#.###.#.###.#.###.#.###.#.#########.#.#.#.#.#.#.#.###.#.#.#.#.#######.#
#.....#.........#.....#...#.#...#.#.....#.#.....#...#.#...#...#.#.#.#.#...#.#...#.#...#.#.#...#...#...###.#...#...#...#...#.#.#.#...#.......#
#.###############.###.#.###.###.#.#####.#.###########.#.#.#.###.#.#.#.###.#.###.#.###.#.#.#.#####.#.#.###.###############.#.#.#.#####.#######
#.#.....#.........###...###.#...#.....#.#.........#...#.#.#...#.#.#.#.#...#.#...#.#...#.#.#...#...#.#.#...#...#...#...#...#.#...#...#.......#
#.#.###.#.#################.#.#######.#.#########.#.###.#.###.#.#.#.#.#.###.#.###.#.###.#.###.#.###.#.#.###.#.#.#.#.#.#.###.#####.#.#######.#
#...#...#.###...#...#.......#.#...#...#.#...#.....#.#...#.#...#.#.#...#...#.#...#.#.#...#.#...#.#...#.#.#...#...#...#...#...#.....#...#...#.#
#####.###.###.#.#.#.#.#######.#.#.#.###.#.#.#.#####.#.###.#.###.#.#######.#.###.#.#.#.###.#.###.#.###.#.#.###############.###.#######.#.#.#.#
#...#.....#...#...#...#.....#.#.#.#...#.#.#.#.....#.#.#...#.#...#...#####.#.#...#.#.#.#...#.#...#.###.#.#.#...#...#...###...#.......#.#.#.#.#
#.#.#######.###########.###.#.#.#.###.#.#.#.#####.#.#.#.###.#.#####.#####.#.#.###.#.#.#.###.#.###.###.#.#.#.#.#.#.#.#.#####.#######.#.#.#.#.#
#.#.......#...#...#...#.#...#...#.....#...#...#...#...#...#.#.....#...#...#.#...#.#...#...#.#...#...#...#...#...#...#...###.#...#...#...#...#
#.#######.###.#.#.#.#.#.#.###################.#.#########.#.#####.###.#.###.###.#.#######.#.###.###.###################.###.#.#.#.###########
#...#...#.....#.#.#.#...#...#...#...........#.#.#...#.....#.....#...#.#...#.###.#.......#...###...#...#.................#...#.#.#.#...#...###
###.#.#.#######.#.#.#######.#.#.#.#########.#.#.#.#.#.#########.###.#.###.#.###.#######.#########.###.#.#################.###.#.#.#.#.#.#.###
###...#...#.....#...#.....#...#...#.........#.#...#.#...........#...#...#.#...#.#...#...#.........#...#...#...#...#...#...#...#.#...#.#.#...#
#########.#.#########.###.#########.#########.#####.#############.#####.#.###.#.#.#.#.###.#########.#####.#.#.#.#.#.#.#.###.###.#####.#.###.#
#...#...#...###.....#...#.#...#.....#.....###.......#.......###...#...#.#.#...#.#.#.#.###.....#...#.#...#...#...#...#...#...###.......#...#.#
#.#.#.#.#######.###.###.#.#.#.#.#####.###.###########.#####.###.###.#.#.#.#.###.#.#.#.#######.#.#.#.#.#.#################.###############.#.#
#.#...#...#...#.#...#...#...#...#...#.#...#...#...###.....#.....#...#.#.#...###.#.#.#.#.......#.#...#.#.#...#...#...#.....#...###...###...#.#
#.#######.#.#.#.#.###.###########.#.#.#.###.#.#.#.#######.#######.###.#.#######.#.#.#.#.#######.#####.#.#.#.#.#.#.#.#.#####.#.###.#.###.###.#
#.......#.#.#.#.#...#.......#.....#...#.....#...#.....###.....#...###.#.......#.#.#...#...#...#.#.....#.#.#.#.#...#.#.......#.....#.....#...#
#######.#.#.#.#.###.#######.#.#######################.#######.#.#####.#######.#.#.#######.#.#.#.#.#####.#.#.#.#####.#####################.###
###...#.#.#.#.#...#.#.......#.#...#.....#...#...#...#.#.......#.....#.#.....#.#...#...#...#.#.#.#.#...#...#.#...###.................#.....###
###.#.#.#.#.#.###.#.#.#######.#.#.#.###.#.#.#.#.#.#.#.#.###########.#.#.###.#.#####.#.#.###.#.#.#.#.#.#####.###.###################.#.#######
#...#...#...#...#.#.#.........#.#.#...#.#.#.#.#.#.#.#.#...#...#...#.#...###...#.....#.#...#.#...#...#.....#...#.#...#.......#.....#.#.......#
#.#############.#.#.###########.#.###.#.#.#.#.#.#.#.#.###.#.#.#.#.#.###########.#####.###.#.#############.###.#.#.#.#.#####.#.###.#.#######.#
#.............#...#...#.....#...#.....#...#...#...#...#...#.#...#.#.........###.....#...#...#...#...#...#...#...#.#.#.#.....#.#...#.....#...#
#############.#######.#.###.#.#########################.###.#####.#########.#######.###.#####.#.#.#.#.#.###.#####.#.#.#.#####.#.#######.#.###
#...........#.......#.#...#...#.........#.............#.....###...#...#...#.#.......#...###...#...#...#.....#...#.#.#.#.......#.......#.#...#
#.#########.#######.#.###.#####.#######.#.###########.#########.###.#.#.#.#.#.#######.#####.#################.#.#.#.#.###############.#.###.#
#...#.....#.........#.....#...#.#.......#.#.....#.....#.........#...#.#.#...#...#...#.......#.................#...#...#...#...#.....#.#.....#
###.#.###.#################.#.#.#.#######.#.###.#.#####.#########.###.#.#######.#.#.#########.#########################.#.#.#.#.###.#.#######
###...###...#.....#...#...#.#.#.#.......#.#...#.#.....#.#.....#...#...#.#...#...#.#...#.....#.#.......#.........#...#...#...#.#...#...#.....#
###########.#.###.#.#.#.#.#.#.#.#######.#.###.#.#####.#.#.###.#.###.###.#.#.#.###.###.#.###.#.#.#####.#.#######.#.#.#.#######.###.#####.###.#
#...........#.#...#.#.#.#...#...###.....#.#...#.......#...###.#.###...#...#.#.....###.#.###...#.....#.#.....###...#...#...###.#...#...#.#...#
#.###########.#.###.#.#.###########.#####.#.#################.#.#####.#####.#########.#.###########.#.#####.###########.#.###.#.###.#.#.#.###
#...#...#...#.#...#.#.#.#...........#.....#.............#.....#.#...#.....#.###.......#.#.......#...#.......#.......###.#...#.#...#.#...#...#
###.#.#.#.#.#.###.#.#.#.#.###########.#################.#.#####.#.#.#####.#.###.#######.#.#####.#.###########.#####.###.###.#.###.#.#######.#
###...#...#...###...#...#.#...........#.................#.....#...#.....#.#.#...#...#...#.....#.#.............#...#...#...#.#.....#.#.......#
#########################.#.###########.#####################.#########.#.#.#.###.#.#.#######.#.###############.#.###.###.#.#######.#.#######
###...###.........#.....#...#...........#...#...#...#.......#...#...#...#...#.....#...#...#...#.........#.......#...#.....#.........#.......#
###.#.###.#######.#.###.#####.###########.#.#.#.#.#.#.#####.###.#.#.#.#################.#.#.###########.#.#########.#######################.#
#...#...#.......#.#.#...#...#.............#...#...#.#.#.....#...#.#.#.....#...###.......#...#.........#.#.....#...#.......#...#...........#.#
#.#####.#######.#.#.#.###.#.#######################.#.#.#####.###.#.#####.#.#.###.###########.#######.#.#####.#.#.#######.#.#.#.#########.#.#
#.....#.#...#...#...#.....#.................#.......#.#.....#.....#.......#.#.#...#.........#.###.....#.......#.#.....###...#...#...#...#...#
#####.#.#.#.#.#############################.#.#######.#####.###############.#.#.###.#######.#.###.#############.#####.###########.#.#.#.#####
#...#.#.#.#...#.......#...................#.#.###.....#.....#...###.....#...#.#.....###...#...#...#.............#...#.............#...#.....#
#.#.#.#.#.#####.#####.#.#################.#.#.###.#####.#####.#.###.###.#.###.#########.#.#####.###.#############.#.#######################.#
#.#.#.#.#.......#...#...#...#...........#.#.#.....#...#.#.....#.....#...#...#.....###...#.#...#.....#...#...#.....#...#...#...#...#.....#...#
#.#.#.#.#########.#.#####.#.#.#########.#.#.#######.#.#.#.###########.#####.#####.###.###.#.#.#######.#.#.#.#.#######.#.#.#.#.#.#.#.###.#.###
#.#.#.#.#.....#...#.###...#...#.......#.#.#.#.......#.#.#.........#...#...#.....#...#...#.#.#.........#...#...#.....#.#.#.#.#.#.#...###...###
#.#.#.#.#.###.#.###.###.#######.#####.#.#.#.#.#######.#.#########.#.###.#.#####.###.###.#.#.###################.###.#.#.#.#.#.#.#############
#.#.#.#.#...#.#.#...#...#...#...###...#...#.#.......#...#...#...#.#.....#...###...#.#...#.#...#...#...#.......#...#.#...#...#.#.........#...#
#.#.#.#.###.#.#.#.###.###.#.#.#####.#######.#######.#####.#.#.#.#.#########.#####.#.#.###.###.#.#.#.#.#.#####.###.#.#########.#########.#.#.#
#.#...#...#.#.#.#.#...#...#.#.#.....###...#.....#...#...#.#.#.#.#.......#...#...#.#...#...###...#...#.#.#.....#...#.........#.#.......#.#.#.#
#.#######.#.#.#.#.#.###.###.#.#.#######.#.#####.#.###.#.#.#.#.#.#######.#.###.#.#.#####.#############.#.#.#####.###########.#.#.#####.#.#.#.#
#...#...#...#...#...#...###.#.#.#.......#.....#.#.#...#.#.#.#.#.#...#...#.....#...#.....###...........#.#.......#...#.......#...#...#.#...#.#
###.#.#.#############.#####.#.#.#.###########.#.#.#.###.#.#.#.#.#.#.#.#############.#######.###########.#########.#.#.###########.#.#.#####.#
#...#.#.#.....#...#...#...#...#...#...#.......#...#.#...#.#.#.#.#.#.#.....#.......#.#.....#.#...........#.........#...#...#...###.#.#...#...#
#.###.#.#.###.#.#.#.###.#.#########.#.#.###########.#.###.#.#.#.#.#.#####.#.#####.#.#.###.#.#.###########.#############.#.#.#.###.#.###.#.###
#.....#.#...#.#.#.#.###.#...#...#...#...#.......###.#.#...#...#.#.#.....#...#...#.#.#.#...#...###...###...#.......#...#.#...#.....#...#...###
#######.###.#.#.#.#.###.###.#.#.#.#######.#####.###.#.#.#######.#.#####.#####.#.#.#.#.#.#########.#.###.###.#####.#.#.#.#############.#######
#.......#...#.#.#...#...#...#.#.#...#...#.#...#...#.#.#.......#.#.#.....#...#.#.#.#.#.#.....###...#...#.....#...#...#...#...#.........#...###
#.#######.###.#.#####.###.###.#.###.#.#.#.#.#.###.#.#.#######.#.#.#.#####.#.#.#.#.#.#.#####.###.#####.#######.#.#########.#.#.#########.#.###
#.....#...#...#.....#...#.....#.....#.#.#...#.#...#.#.#.....#.#.#.#...#...#...#.#.#...#.....#...#...#.###.....#...........#.#...........#...#
#####.#.###.#######.###.#############.#.#####.#.###.#.#.###.#.#.#.###.#.#######.#.#####.#####.###.#.#.###.#################.###############.#
###...#...#...#.....###...#...........#...###.#.###.#.#...#.#.#...#...#.....#...#...#...#...#...#.#...#...#...#...........#.#.........#.....#
###.#####.###.#.#########.#.#############.###.#.###.#.###.#.#.#####.#######.#.#####.#.###.#.###.#.#####.###.#.#.#########.#.#.#######.#.#####
#...#.....###.#.#.........#.#...........#.#...#.....#...#.#.#.....#.#...#...#.......#.#...#...#.#.....#.....#.#.#.........#...#...###.#.....#
#.###.#######.#.#.#########.#.#########.#.#.###########.#.#.#####.#.#.#.#.###########.#.#####.#.#####.#######.#.#.#############.#.###.#####.#
#...#.......#.#.#.#.......#.#...#...###...#...#.........#.#.#...#.#.#.#.#...#.........#.....#.#...#...###...#...#...#...###...#.#.#...#...#.#
###.#######.#.#.#.#.#####.#.###.#.#.#########.#.#########.#.#.#.#.#.#.#.###.#.#############.#.###.#.#####.#.#######.#.#.###.#.#.#.#.###.#.#.#
#...#...#...#.#.#...#.....#...#...#.#...#...#.#.#...#...#.#.#.#...#.#.#...#.#.....#########.#.#...#...#...#...#...#...#...#.#.#.#.#.....#...#
#.###.#.#.###.#.#####.#######.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.###.#.#####.#########.#.#.#####.#.#####.#.#.#######.#.#.#.#.###########
#.....#.#...#...###...#.....#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#...#.#.....#.#########.#.#...#...#.....#...#.#.....#...#...#.###.......#
#######.###.#######.###.###.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#######.#.#####.#.#########.#.###.#.#######.#####.#.###.#########.###.#####.#
###...#.....#...#...#...#...#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.....#.#########.#.#...#...#...#.....#...###.........#...#.#.....#
###.#.#######.#.#.###.###.###.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#####.#########.#.#.#####.#.#.#####.###############.###.#.#.#####
#...#.........#.#.....###.....#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#...#...#########.#.#.....#.#.#.......#...........###...#...#.#...#
#.#############.###############.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.###.#.###########.#.#####.#.#.#########.#########.#####.#####.#.#.#
#.#...#...#...#.........###...#.....#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#.###########.#...#...#.#...........#.....#...#...#.....#...#.#
#.#.#.#.#.#.#.#########.###.#.#####.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.###.###.#.#.###########.###.#.###.#############.###.#.###.#.#####.#####.#
#.#.#.#.#...#...#.....#.....#.......#.#.#.#.#.....#.#.#.#.#.#.#.#.#...#...#.#.#.#########...#...#...#.#...#.......#...#...#...#...#...#...#.#
#.#.#.#.#######.#.###.###############.#.#.#.#####.#.#.#.#.#.#.#.#.###.###.#.#.#.#########.###.#####.#.#.#.#.#####.###.#####.#####.#.###.#.#.#
#.#.#...###.....#.###...#...#...#...#.#.#.#...#...#.#.#...#.#.#.#.#...#...#.#.#.#########.#...#...#.#.#.#.#.....#...#.......#.....#.....#.#.#
#.#.#######.#####.#####.#.#.#.#.#.#.#.#.#.###.#.###.#.#####.#.#.#.#.###.###.#.#.#########.#.###.#.#.#.#.#.#####.###.#########.###########.#.#
#.#.#.......#.....#...#...#...#.#.#.#.#.#.#...#...#...#.....#.#.#.#...#...#...#...#######.#.....#.#.#.#.#.#...#.#...#.......#.......#...#...#
#.#.#.#######.#####.#.#########.#.#.#.#.#.#.#####.#####.#####.#.#.###.###.#######.#######.#######.#.#.#.#.#.#.#.#.###.#####.#######.#.#.#####
#...#...#...#.#.....#.#.........#.#.#.#.#.#.....#.....#.....#.#...#...#...#.......#######.#.......#.#.#.#...#.#.#...#.....#.#.....#...#.....#
#######.#.#.#.#.#####.#.#########.#.#.#.#.#####.#####.#####.#.#####.###.###.#############.#.#######.#.#.#####.#.###.#####.#.#.###.#########.#
###...#...#...#.....#.#.........#.#...#.#.#.....#.....#.....#...###.....#...#..E#########.#.#.....#.#.#.....#...###.#...#.#.#...#...........#
###.#.#############.#.#########.#.#####.#.#.#####.#####.#######.#########.###.###########.#.#.###.#.#.#####.#######.#.#.#.#.###.#############
#...#...#.........#.#...........#...###.#.#.....#.....#...#...#.........#...#...#########.#.#.#...#.#.#.....###.....#.#...#...#.............#
#.#####.#.#######.#.###############.###.#.#####.#####.###.#.#.#########.###.###.#########.#.#.#.###.#.#.#######.#####.#######.#############.#
#...#...#.......#...#...#...#.....#...#...#.....#.....###.#.#...#...#...#...#...#######...#.#.#...#.#.#...#...#.#...#.......#...#...#.....#.#
###.#.#########.#####.#.#.#.#.###.###.#####.#####.#######.#.###.#.#.#.###.###.#########.###.#.###.#.#.###.#.#.#.#.#.#######.###.#.#.#.###.#.#
#...#.#.........#...#.#.#.#.#.###...#...#...#...#...#.....#...#...#.#...#...#.#########.###...#...#.#.#...#.#.#...#.#.....#.###.#.#.#...#.#.#
#.###.#.#########.#.#.#.#.#.#.#####.###.#.###.#.###.#.#######.#####.###.###.#.#########.#######.###.#.#.###.#.#####.#.###.#.###.#.#.###.#.#.#
#...#...#...#.....#.#.#...#.#.....#.#...#...#.#.#...#...#...#.....#.#...#...#.......###.......#...#.#.#.....#...#...#...#...#...#.#.#...#...#
###.#####.#.#.#####.#.#####.#####.#.#.#####.#.#.#.#####.#.#.#####.#.#.###.#########.#########.###.#.#.#########.#.#####.#####.###.#.#.#######
#...#.....#.#.#.....#.#.....#.....#.#.#...#...#.#...#...#.#.#.....#.#.###.#.....#...#######...#...#.#...#.....#.#...#...#...#.#...#.#.......#
#.###.#####.#.#.#####.#.#####.#####.#.#.#.#####.###.#.###.#.#.#####.#.###.#.###.#.#########.###.###.###.#.###.#.###.#.###.#.#.#.###.#######.#
#.#...#.....#.#...#...#.....#.....#...#.#.......#...#...#.#.#.....#.#.#...#...#.#...#######...#.#...###.#...#.#.#...#.....#.#...###...#.....#
#.#.###.#####.###.#.#######.#####.#####.#########.#####.#.#.#####.#.#.#.#####.#.###.#########.#.#.#####.###.#.#.#.#########.#########.#.#####
#.#...#...#...#...#.#.......#...#.#...#.#.....#...#...#...#...#...#...#...#...#.#...#######...#.#.....#...#.#.#.#...#.....#.....#####.#.....#
#.###.###.#.###.###.#.#######.#.#.#.#.#.#.###.#.###.#.#######.#.#########.#.###.#.#########.###.#####.###.#.#.#.###.#.###.#####.#####.#####.#
#.#...###.#...#...#.#.#...#...#.#.#.#...#.#...#.###.#.#.......#.....###...#.#...#.....###...###...#...###...#...###.#...#.#...#...#...#...#.#
#.#.#####.###.###.#.#.#.#.#.###.#.#.#####.#.###.###.#.#.###########.###.###.#.#######.###.#######.#.###############.###.#.#.#.###.#.###.#.#.#
#.#...#...#...#...#.#.#.#.#.#...#.#.#...#.#.#...#...#...#.....#...#.#...#...#.#...#...###.....#...#.#...............#...#.#.#...#.#...#.#.#.#
#.###.#.###.###.###.#.#.#.#.#.###.#.#.#.#.#.#.###.#######.###.#.#.#.#.###.###.#.#.#.#########.#.###.#.###############.###.#.###.#.###.#.#.#.#
#.....#.....###.....#...#...#.....#...#...#...###.........###...#...#.....###...#...###S......#.....#.................###...###...###...#...#
#############################################################################################################################################`;

input = input.split("\n").map((str) => str.split(""));

const n = input.length;
const m = input[0].length;

let startX;
let startY;
let endX;
let endY;

for (let i = 0; i < n; i++)
  for (let j = 0; j < m; j++)
    if (input[i][j] === "S") {
      startX = j;
      startY = i;
    } else if (input[i][j] === "E") {
      endX = j;
      endY = i;
    }

input[endY][endX] = ".";
input[startY][startX] = ".";

const lowestScoreMapFromStart = Array(n)
  .fill()
  .map(() => Array(m).fill(Infinity));

const queueFromStart = [[startX, startY, 0]];
for (const [x, y, points] of queueFromStart) {
  if (lowestScoreMapFromStart[y][x] <= points) continue;
  if (input[y][x] === "#") continue;
  lowestScoreMapFromStart[y][x] = points;

  queueFromStart.push([x + 1, y, points + 1]);
  queueFromStart.push([x, y + 1, points + 1]);
  queueFromStart.push([x - 1, y, points + 1]);
  queueFromStart.push([x, y - 1, points + 1]);
}

const lowestScoreMapToEnd = Array(n)
  .fill()
  .map(() => Array(m).fill(Infinity));

const queueToEnd = [[endX, endY, 0]];

for (const [x, y, points] of queueToEnd) {
  if (lowestScoreMapToEnd[y][x] <= points) continue;
  if (input[y][x] === "#") continue;
  lowestScoreMapToEnd[y][x] = points;

  queueToEnd.push([x - 1, y, points + 1]);
  queueToEnd.push([x, y - 1, points + 1]);
  queueToEnd.push([x + 1, y, points + 1]);
  queueToEnd.push([x, y + 1, points + 1]);
}

const scoreNoCheat = lowestScoreMapFromStart[endY][endX];

// directions
// 0: east
// 1: south
// 2: west
// 3: north

function getPicosecondsSaved(cheat) {
  const [x, y, direction] = cheat;
  if (input[y][x] !== ".") return -Infinity;

  const scoreSoFar = lowestScoreMapFromStart[y][x];

  switch (direction) {
    case 0:
      if (input[y][x + 1] !== "#" || input[y][x + 2] !== ".") return -Infinity;
      return scoreNoCheat - (scoreSoFar + lowestScoreMapToEnd[y][x + 2] + 2);
    case 1:
      if (input[y + 1]?.[x] !== "#" || input[y + 2]?.[x] !== ".")
        return -Infinity;
      return scoreNoCheat - (scoreSoFar + lowestScoreMapToEnd[y + 2][x] + 2);
    case 2:
      if (input[y][x - 1] !== "#" || input[y][x - 2] !== ".") return -Infinity;
      return scoreNoCheat - (scoreSoFar + lowestScoreMapToEnd[y][x - 2] + 2);
    case 3:
      if (input[y - 1]?.[x] !== "#" || input[y - 2]?.[x] !== ".")
        return -Infinity;
      return scoreNoCheat - (scoreSoFar + lowestScoreMapToEnd[y - 2][x] + 2);
  }
}

let result = 0;
for (let y = 0; y < n; y++)
  for (let x = 0; x < m; x++)
    for (let direction = 0; direction < 4; direction++) {
      const saved = getPicosecondsSaved([x, y, direction]);
      if (saved >= 100) result++;
    }
console.log(result);
