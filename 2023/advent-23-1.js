let input = `#.###########################################################################################################################################
#.......#.........#.....#...#...#.......#...###...#...#...#.......#####...#####.......#...#...#.....#.........#####.....#.......#...###...###
#######.#.#######.#.###.#.#.#.#.#.#####.#.#.###.#.#.#.#.#.#.#####.#####.#.#####.#####.#.#.#.#.#.###.#.#######.#####.###.#.#####.#.#.###.#.###
#.......#.......#.#.#...#.#.#.#.#...#...#.#...#.#.#.#.#.#.#.#...#...#...#...#...#...#.#.#.#.#.#...#.#.......#.....#.#...#.....#.#.#.....#...#
#.#############.#.#.#.###.#.#.#.###.#.###.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.###.#.#.#.#.#.#.###.#.#######.#####.#.#.#######.#.#.#########.#
#.#.......#...#.#.#.#.###.#...#...#.#.#...#...#.#.#.#...#.#...#...#.#...#...#...#.#...#.#.#.#...#.#.#.>.>...#.....#.#.#...#...#.#.#.........#
#.#.#####.#.#.#.#.#.#.###.#######.#.#.#.###.###.#.#.#####.#######.#.###.#.#####.#.#####.#.#.###.#.#.#.#v#####.#####.#.#.#.#.###.#.#.#########
#.#.#.....#.#.#.#.#.#...#...#.....#.#...#...#...#.#.....#.#...###.#.#...#.#...#.#.#.>.>.#.#...#.#.#.#.#...###.#.....#.#.#.#...#.#.#.#.......#
#.#.#.#####.#.#.#.#.###.###.#.#####.#####.###.###.#####.#.#.#.###.#.#.###.#.#.#.#.#.#v###.###.#.#.#.#.###.###.#.#####.#.#.###.#.#.#.#.#####.#
#...#...###.#.#.#.#.#...###.#.#...#...#...###...#.#...#.#...#.#...#.#.###.#.#.#.#...#...#.#...#...#...#...#...#.....#.#.#.###.#.#.#.#.#.....#
#######.###.#.#.#.#.#.#####.#.#.#.###.#.#######.#.#.#.#.#####.#.###.#.###.#.#.#.#######.#.#.###########.###.#######.#.#.#.###.#.#.#.#.#.#####
#...#...#...#.#.#.#.#...#...#.#.#.#...#...>.>.#.#...#.#.....#.#...#.#...#.#.#.#.#.......#...#####...#...###...#...#.#.#.#.#...#...#...#.....#
#.#.#v###.###.#.#.#.###.#.###.#.#.#.#######v#.#.#####.#####.#.###.#.###.#.#.#.#.#.###############.#.#.#######.#.#.#.#.#.#.#.###############.#
#.#.#.>.#...#.#.#.#.#...#.#...#.#...###...#.#.#...#...#...#.#.....#.#...#.#.#...#.............#...#.#.......#.#.#.#.#.#.#.#...#.....#.......#
#.#.#v#.###.#.#.#.#.#.###.#.###.#######.#.#.#.###.#.###.#.#.#######.#.###.#.#################.#.###.#######.#.#.#.#.#.#.#.###.#.###.#.#######
#.#...#.....#.#.#...#...#.#.#...###...#.#...#...#.#.>.>.#.#.#...#...#...#...#...............#.#...#.###...#.#...#.#.#...#.....#...#.#.......#
#.###########.#.#######.#.#.#.#####.#.#.#######.#.###v###.#.#.#.#.#####.#####.#############.#.###.#.###.#.#.#####.#.#############.#.#######.#
#.#.........#.#.....#...#.#.#.#.....#.#.#...###.#...#...#...#.#.#.....#.....#.........#...#...#...#.....#...###...#.###...###...#.#.#.......#
#.#.#######.#.#####.#.###.#.#.#.#####.#.#.#.###.###.###.#####.#.#####.#####.#########.#.#.#####.###############.###.###.#.###.#.#.#.#.#######
#.#.#.......#.......#.....#...#.....#...#.#.....#...###.......#.....#.#.....#...#...#...#...#...#...#.........#...#.#...#.....#...#.#.....###
#.#.#.#############################.#####.#######.#################.#.#.#####.#.#.#.#######.#.###.#.#.#######.###.#.#.#############.#####.###
#.#.#...........#.................#...###...#...#...#...........#...#...#...#.#.#.#.#.......#.....#...#.......###...#.............#.#...#...#
#.#.###########.#.###############.###.#####.#.#.###.#.#########.#.#######.#.#.#.#.#.#.#################.#########################.#.#.#.###.#
#...#...#.......#.#...#.........#...#...#...#.#.#...#.....#...#...#...#...#...#...#...###...#...........#...#...#.....#...........#...#...#.#
#####.#.#.#######.#.#.#.#######.###.###.#.###.#.#.#######.#.#.#####.#.#.#################.#.#.###########.#.#.#.#.###.#.#################.#.#
#.....#.#.......#...#...#.......###.#...#.#...#...#######...#...###.#.#.................#.#.#.....#.......#.#.#.#.#...#...#.............#.#.#
#.#####.#######.#########.#########.#.###.#.###################.###.#.#################.#.#.#####.#.#######.#.#.#.#.#####.#.###########.#.#.#
#.....#.........###...###.........#.#...#...#.......#.........#.#...#.#...###...........#.#.....#...###.....#.#...#.....#.#.#.........#.#.#.#
#####.#############.#.###########.#.###.#####.#####.#.#######.#.#.###.#.#.###.###########.#####.#######.#####.#########.#.#.#.#######.#.#.#.#
#####.........###...#.#...........#...#.#...#.....#.#.......#...#.#...#.#...#.....#.....#.#.....###.....#...#.#.........#...#.......#...#...#
#############.###.###.#.#############.#.#.#.#####.#.#######.#####.#.###.###.#####.#.###.#.#.#######.#####.#.#.#.###################.#########
#.............#...#...#.........#...#...#.#.#...#.#.###...#.....#.#...#.#...#...#...#...#.#...#...#.....#.#.#.#.#...#####...###...#.........#
#.#############.###.###########.#.#.#####.#.#.#.#.#.###.#.#####.#.###.#.#.###.#.#####v###.###.#.#.#####.#.#.#.#.#.#.#####.#.###v#.#########.#
#.#...###...###.#...###...###...#.#.#...#.#.#.#.#.#.#...#.......#...#...#.#...#.#...>.>...#...#.#.#...#.#.#.#.#.#.#...#...#...>.#...........#
#.#.#.###.#.###.#.#####.#.###.###.#.#.#.#.#.#.#.#.#.#.#############.#####.#.###.#.###v#####.###.#.#.#.#v#.#.#.#.#.###.#.#######v#############
#...#.....#...#.#...#...#...#...#.#.#.#.#.#.#.#.#.#.#.......#.....#...#...#.###...###.###...#...#.#.#.>.>.#.#.#.#.###.#.....#...###...#...###
#############.#.###.#.#####.###.#.#.#.#.#.#.#.#.#.#.#######v#.###.###.#.###.#########.###.###.###.#.###v###.#.#.#.###.#####.#.#####.#.#.#.###
#...#.........#...#.#...#...###.#.#.#.#.#.#...#.#.#.......>.>.###.#...#.#...#.......#...#...#.###.#.###...#.#.#.#.###.#.....#.......#...#...#
#.#.#.###########.#.###.#.#####v#.#.#.#.#.#####.#.#########v#####.#.###.#.###.#####.###.###.#.###.#.#####.#.#.#.#.###.#.###################.#
#.#...#...#...#...#...#.#...#.>.>.#.#.#.#.#.....#...#.....#.#...#...###...###.....#...#...#...#...#...#...#...#...###.#.#...................#
#.#####.#.#.#.#.#####.#.###.#.#v###.#.#.#.#.#######.#.###.#.#.#.#################.###.###.#####.#####.#.#############.#.#.###################
#.#...#.#.#.#.#.....#.#...#...#...#.#.#.#.#.#...#...#...#.#...#.........#...#...#...#...#...#...#.....#...#...#.....#...#...................#
#.#.#v#.#.#.#.#####.#.###.#######.#.#.#.#.#.#.#.#.#####.#.#############.#.#.#.#.###.###.###.#.###.#######.#.#.#.###.#######################.#
#...#.>.#...#...#...#.#...#.......#...#...#.#.#.#.#.....#.......#.......#.#.#.#.#...###.#...#...#.#.....#.#.#...#...###...#...........#...#.#
#####v#########.#.###.#.###.###############.#.#.#.#.###########.#.#######.#.#.#.#.#####.#.#####.#.#.###.#.#.#####.#####.#.#.#########.#.#.#.#
#.....#####...#.#.###.#.###...#.........###...#...#...........#...#...#...#...#...#...#.#.#...#...#...#...#.#.....#.....#.#.#.......#.#.#.#.#
#.#########.#.#.#.###.#.#####.#.#######.#####################.#####.#.#.###########.#.#.#.#.#.#######.#####.#.#####.#####.#.#.#####.#.#.#.#.#
#.#.......#.#.#.#...#...#...#...#.......#...#.................#.....#.#.............#.#...#.#.#...###...#...#.....#.....#.#...#.....#...#...#
#.#.#####.#.#.#.###.#####.#.#####.#######.#.#.#################.#####.###############.#####.#.#.#.#####.#.#######.#####.#.#####.#############
#.#.#.....#.#.#...#.#.....#.#...#.....#...#.#.....#...#...#...#.....#.#...#...#.......#.....#.#.#.#.....#.###.....#...#.#.#...#.............#
#.#.#.#####.#.###.#.#.#####.#.#.#####.#.###.#####.#.#.#.#.#.#.#####.#.#.#.#.#.#.#######.#####.#.#.#.#####.###.#####.#.#.#.#.#.#############.#
#...#...#...#...#...#.#...#...#.......#...#.....#...#.#.#...#.#.....#.#.#.#.#.#.###...#.#.....#.#.#.....#.#...#.....#.#.#...#...............#
#######.#.#####.#####.#.#.###############.#####.#####.#.#####.#.#####.#.#.#.#.#v###.#.#.#.#####.#.#####.#.#.###.#####.#.#####################
#.......#.#.....#...#...#...............#.....#.....#...#.....#.....#.#.#...#.>.>.#.#.#.#...#...#...###...#...#.....#.#.....................#
#.#######.#.#####.#.###################.#####.#####.#####.#########.#.#.#######v#.#.#.#.###.#.#####.#########.#####.#.#####################.#
#.#.....#.#.###...#.#...#...............#...#...#...#.....#...#...#.#.#.#.......#.#.#.#.#...#.....#.###...###.#...#.#.....#...............#.#
#.#.###.#.#.###.###.#.#.#.###############.#.###.#.###.#####.#.#.#.#.#.#.#.#######.#.#.#.#.#######.#.###.#.###v#.#.#.#####.#.#############.#.#
#.#...#...#...#...#...#.#.........#...#...#.....#...#.###...#.#.#...#.#.#.......#...#.#.#...#...#.#.#...#.#.>.>.#...#.....#.............#...#
#.###.#######v###.#####.#########.#.#.#.###########.#.###.###.#.#####.#.#######.#####.#.###.#.#.#.#.#.###.#.#v#######.#################.#####
#...#.#.....#.>.#.#.....#...#.....#.#.#.........#...#...#...#.#.#...#.#.###...#.....#.#.#...#.#.#.#.#.#...#.#.#.......#...#...........#.....#
###.#.#.###.#v#.#.#.#####.#.#.#####.#.#########.#.#####.###.#.#.#.#.#.#.###.#.#####.#.#.#.###.#.#.#.#.#.###.#.#.#######.#.#.#########.#####.#
###.#.#...#.#.#.#.#.#...#.#.#.#...#.#.###...###.#.###...###.#...#.#.#.#.#...#.......#...#...#.#...#.#.#...#.#.#.....###.#.#.....#...#...#...#
###.#.###.#.#.#.#.#.#.#.#.#.#v#.#.#.#.###.#.###.#.###v#####.#####.#.#.#.#.#################.#.#####.#.###.#.#.#####.###.#.#####.#.#.###.#.###
###.#.#...#...#.#.#.#.#.#.#.>.>.#...#.#...#.#...#.#.>.>...#.....#.#.#...#.............#.....#.#...#...#...#.#.###...#...#.#...#...#...#...###
###.#.#.#######.#.#.#.#.#.###v#######.#.###.#.###.#.#v###.#####.#.#.#################.#.#####.#.#.#####.###.#.###.###.###.#.#.#######.#######
#...#.#...#...#...#...#.#.#...#...###...#...#...#.#.#...#.#.....#.#.#...#...#...#.....#.....#...#...#...#...#...#...#.#...#.#.#.......###...#
#.###.###.#.#.#########.#.#.###.#.#######.#####.#.#.###.#.#.#####.#.#.#.#.#.#.#.#.#########.#######.#.###.#####.###.#.#.###.#.#v#########.#.#
#...#.###...#.....#.....#.#.#...#.....#...#...#.#...###.#.#.....#.#...#...#...#.#.....#...#.........#.....#...#.###...#...#.#.>.#.........#.#
###.#.###########.#.#####.#.#.#######.#.###.#.#.#######.#.#####.#.#############.#####.#.#.#################.#.#.#########.#.###v#.#########.#
###...#...#.......#.......#.#.#.......#.#...#...#.......#.......#.............#.#.....#.#.#.........###.....#...#...#####...###...#.......#.#
#######.#.#.###############.#.#.#######.#.#######.###########################.#.#.#####.#.#.#######.###.#########.#.###############.#####.#.#
#.......#.#...#...#####.....#.#...#...#...#.....#.........#.........#.........#.#.....#.#.#.......#...#.......#...#...###...#.......#...#...#
#.#######.###.#.#.#####.#####.###.#.#.#####.###.#########.#.#######.#.#########.#####.#.#.#######.###.#######.#.#####.###.#.#.#######.#.#####
#...#...#.....#.#.....#.....#.#...#.#...###.#...#.....###...#.......#.........#.......#.#.#.....#...#.#.......#...#...#...#...#...###.#.....#
###.#.#.#######.#####.#####.#.#.###.###.###.#.###.###.#######v###############.#########.#.#.###.###.#.#.#########.#.###.#######.#.###.#####.#
###...#.........#.....#...#.#.#...#.#...#...#.#...#...#...#.>.>...###...#.....#.....#...#.#.#...#...#.#.....#...#.#...#.........#.....#.....#
#################.#####.#.#.#.###.#.#.###.###.#.###.###.#.#.#v###.###.#.#.#####.###.#.###.#.#.###.###.#####.#.#.#.###.#################.#####
#...#.............#...#.#.#...#...#.#...#.#...#...#...#.#...#...#...#.#.#.....#.#...#...#.#.#.###...#.#...#.#.#.#...#.#.................#...#
#.#.#.#############.#.#.#.#####.###.###.#.#.#####.###.#.#######.###.#.#.#####.#.#.#####.#.#.#.#####.#.#.#.#v#.#.###.#.#.#################.#.#
#.#.#...............#.#.#.....#.....###.#.#.#...#...#.#.#.......#...#.#.###...#.#.#...#.#.#.#.......#...#.>.>.#...#.#.#.................#.#.#
#.#.#################.#.#####.#########.#.#.#.#.###.#.#.#.#######.###.#.###v###.#.#.#.#.#.#.###############v#####.#.#.#################.#.#.#
#.#.......###.......#.#.#.....#...#.....#.#.#.#.....#.#.#.......#...#.#.#.>.>.#.#.#.#.#.#.#.#.........#...#.#.....#.#...#...#.......#...#.#.#
#.#######.###.#####.#.#.#.#####.#.#.#####.#.#.#######.#.#######.###.#.#.#.#v#.#.#.#.#.#.#.#.#.#######.#.#.#.#.#####.###.#.#.#v#####.#.###.#.#
#...#...#.....#...#...#.#...#...#.#.....#.#.#.......#...#...###...#...#.#.#.#...#.#.#.#.#.#.#.......#...#...#.#...#.###.#.#.>.#...#...###.#.#
###.#.#.#######.#.#####.###.#.###.#####.#.#.#######.#####.#.#####.#####.#.#.#####.#.#.#.#.#.#######.#########.#.#.#.###.#.###v#.#.#######.#.#
###...#...#...#.#.#...#.#...#...#.#...#.#.#.#.......#.....#.......#...#...#.....#...#.#.#...###...#.........#...#.#.###.#...#.#.#.#.....#.#.#
#########.#.#.#.#.#.#.#.#.#####.#.#.#.#v#.#.#.#######.#############.#.#########.#####.#.#######.#.#########.#####.#.###.###.#.#.#.#.###.#.#.#
#.........#.#.#.#.#.#.#.#...#...#...#.>.>.#...#...###.....#.........#...#.......#.....#.#.......#.........#.#.....#.#...#...#.#.#.#.#...#.#.#
#.#########.#v#.#.#.#.#.###.#.#########v#######.#.#######.#.###########.#.#######.#####.#.###############.#.#.#####.#.###.###.#.#.#.#.###.#.#
#.#...#.....#.>.#.#.#...###.#...###...#.........#...#.....#.#...........#.......#.......#...............#.#.#.......#.#...###...#...#.....#.#
#.#.#.#.#####v###.#.#######.###.###.#.#############.#.#####.#.#################.#######################.#.#.#########.#.###################.#
#...#...###...###...###.....#...#...#.............#.#.#.....#.#...#.....#.......#.....#.......#.........#...#...#...#...#.................#.#
###########.###########.#####.###.###############.#.#.#.#####.#.#.#.###.#.#######.###.#.#####.#.#############.#.#.#.#####.###############.#.#
#.....#...#.....#.....#...#...###...#.....#...###...#.#.#...#...#...#...#.........#...#.....#.#...........#...#...#.....#...............#.#.#
#.###.#.#.#####.#.###.###.#.#######.#.###.#.#.#######.#.#.#.#########.#############.#######.#.###########.#.###########.###############.#.#.#
#...#.#.#.#...#...#...###.#.#.......#.#...#.#.......#...#.#.#...#...#...#...........###.....#.....#.......#...#.........#...#####...#...#.#.#
###.#.#.#.#.#.#####.#####.#.#.#######.#.###.#######.#####.#.#.#.#.#.###.#.#############.#########.#.#########.#.#########.#.#####.#.#.###.#.#
#...#...#...#.....#.#.....#.#.........#.....#.....#.#.....#...#...#.....#.........#...#...#.....#.#.....#...#.#...#...#...#.#.....#...###.#.#
#.###############.#.#.#####.#################.###.#.#.###########################.#.#.###.#.###.#.#####.#.#.#.###.#.#.#.###.#.###########.#.#
#.....#.....#...#...#.......#...#.............###.#.#...#.............#...........#.#.#...#.###.#.......#.#.#.#...#.#.#...#.#.......#...#...#
#####.#.###.#.#.#############.#.#.###############.#.###.#.###########.#.###########.#.#.###.###.#########.#.#.#.###.#.###.#.#######.#.#.#####
#.....#.###...#...#.....#...#.#.#...#.......#...#...###...###...#.....#.............#.#.#...#...#...#...#.#.#.#.###.#.###.#.#...#...#.#.#...#
#.#####.#########.#.###.#.#.#.#.###v#.#####.#.#.#############.#.#.###################.#.#.###.###.#.#.#.#.#.#.#.###.#.###.#.#.#.#v###.#.#.#.#
#.#...#.#.....#...#...#.#.#.#.#.#.>.>.#.....#.#...###...#.....#...###...###...........#...#...#...#.#.#...#.#.#.#...#...#.#...#.>.###.#.#.#.#
#.#.#.#.#.###.#v#####.#.#.#.#.#.#.#v###.#####.###.###.#.#.###########.#.###v###############.###.###.#.#####.#.#.#.#####.#.#######v###.#.#.#.#
#...#...#...#.#.>...#.#.#.#.#.#...#.###...#...#...#...#.#.....#.......#.#.>.>...#...#...###...#.#...#.....#.#.#.#.#.....#...#####...#.#...#.#
###########.#.#v###.#.#.#.#.#.#####.#####.#.###.###.###.#####.#.#######.#.#v###.#.#.#.#.#####.#.#.#######.#.#.#.#.#.#######.#######.#.#####.#
###...#...#.#...###...#.#.#...#.....#...#...###...#...#...###...#.......#.#...#.#.#.#.#.#...#...#...#.....#...#.#.#.#...#...#.......#...#...#
###.#.#.#.#.###########.#.#####.#####.#.#########.###.###.#######.#######.###.#.#.#.#.#.#.#.#######.#.#########.#.#.#.#.#.###.#########.#.###
#...#.#.#...#...#...###...#...#.......#.....#...#...#.#...#...###.#...###...#.#.#.#.#.#.#.#.#.....#.#.......#...#.#...#.#.#...#...#.....#...#
#.###.#.#####.#.#.#.#######.#.#############.#.#.###.#.#.###.#.###v#.#.#####.#.#.#.#.#.#.#.#.#.###.#.#######.#.###.#####.#.#.###.#.#.#######.#
#...#.#.......#...#.....#...#.....#...#...#...#.#...#.#.....#...>.>.#...#...#.#.#.#.#.#.#.#.#...#.#.#...#...#...#.###...#.#.....#.#.#.......#
###.#.#################.#.#######.#.#.#.#.#####.#.###.###########v#####.#.###.#.#.#.#.#.#.#.###.#.#v#.#.#.#####.#.###.###.#######.#.#.#######
#...#...#...#.....#...#.#.#.....#...#...#.....#.#...#.#...........###...#.#...#...#.#.#...#...#.#.>.>.#...#...#...#...#...###.....#.#.......#
#.#####.#.#.#.###.#.#.#.#.#.###.#############.#.###.#.#.#############.###.#.#######.#.#######.#.###v#######.#.#####.###.#####.#####.#######.#
#.....#...#.#...#...#...#...###...#...#.....#.#...#.#.#.#...........#.....#.......#.#...#.....#.#...#.......#.....#.....###...#...#.#.......#
#####.#####.###.#################.#.#.#.###.#.###.#.#.#.#.#########.#############.#.###.#.#####.#.###.###########.#########.###.#.#.#.#######
#.....#...#.....#...###...#...###...#.#.#...#...#.#...#...#.........#...#...###...#.....#.......#...#.#...........###.....#.#...#.#.#.#...###
#.#####.#.#######.#.###.#.#.#.#######.#.#.#####.#.#########.#########.#.#.#.###.###################.#.#.#############.###.#.#.###.#.#.#.#.###
#.#...#.#...#.....#...#.#.#.#.#.......#.#.#####...###...###.........#.#.#.#...#...#.....#.......###...#.....#...#...#.#...#...###...#...#...#
#.#.#.#.###.#.#######.#.#.#.#.#.#######.#.###########.#.###########.#.#.#.###.###.#.###.#.#####.###########.#.#.#.#.#.#.###################.#
#.#.#.#...#.#.....#...#.#.#.#.#...#...#.#.........#...#.#...........#.#.#.#...#...#...#.#.....#.#...###.....#.#.#.#.#.#.#...#...#...........#
#.#.#.###.#.#####.#.###.#.#.#.###v#.#.#.#########.#.###.#.###########.#.#.#.###v#####.#.#####.#.#.#.###.#####.#.#.#.#.#.#.#.#.#.#.###########
#...#...#.#...#...#.#...#.#.#.#.>.>.#.#.#.........#...#.#.....#...#...#...#...>.>...#.#.....#.#.#.#.#...#.....#.#.#...#.#.#.#.#.#...........#
#######.#.###.#.###.#.###.#.#.#.#####.#.#.###########.#.#####.#.#.#.###############.#.#####.#.#.#.#.#.###.#####.#.#####.#.#.#.#.###########.#
#.......#...#.#...#...#...#.#.#.....#.#.#...###.....#.#.......#.#.#.........#.......#.#.....#.#.#.#.#...#...#...#.#.....#.#.#.#...#.....#...#
#.#########.#.###.#####.###.#.#####.#.#.###.###.###.#.#########.#.#########.#.#######.#.#####.#.#.#.###v###.#.###.#.#####.#.#.###.#.###.#.###
#...#...#...#.....#.....#...#.#...#.#.#.###...#...#.#.........#.#.......#...#.#.....#.#...#...#.#.#.#.>.>.#.#...#.#.#.....#.#...#.#.#...#...#
###.#.#.#.#########.#####.###.#.#.#.#.#.#####.###.#.#########.#.#######.#.###.#.###.#.###.#.###.#.#.#.###.#.###.#.#.#.#####.###.#.#.#.#####.#
###.#.#.#.........#...#...###.#.#.#.#...#...#...#.#.......#...#.......#...###...#...#.#...#.###...#.#.#...#.#...#.#.#.....#.###.#.#.#.###...#
###.#.#.#########.###.#.#####.#.#.#.#####.#.###.#.#######.#.#########.###########.###.#.###.#######.#.#.###.#.###.#.#####.#.###.#.#.#.###v###
###...#...#...#...#...#.#####.#.#.#.#.....#.....#.....#...#...#.....#.......###...#...#...#.....#...#.#...#.#.#...#.#.....#.#...#.#.#.#.>.###
#########.#.#.#.###.###.#####.#.#.#.#.###############.#.#####v#.###.#######.###.###.#####.#####.#.###.###.#.#.#.###.#.#####.#.###.#.#.#.#v###
#.........#.#.#...#...#...#...#.#.#.#.......#...#...#.#...#.>.>.#...#...#...#...#...#...#...#...#...#.###.#.#.#.###.#.#.....#...#.#.#...#...#
#.#########.#.###.###.###.#.###.#.#.#######.#.#.#.#.#.###.#.#####.###.#.#.###.###.###.#.###.#.#####.#.###.#.#.#.###.#.#.#######.#.#.#######.#
#.#.......#.#.....###.#...#.#...#.#.#.......#.#...#.#.###.#...#...#...#.#...#...#.#...#.....#.....#...#...#.#.#.###...#.....#...#.#.#.......#
#.#.#####.#.#########.#.###.#.###.#.#.#######.#####.#.###.###.#.###.###.###.###.#.#.#############.#####.###.#.#.###########.#.###.#.#.#######
#.#.#.....#.........#.#...#.#.#...#.#...#...#.#.....#...#.#...#...#...#...#...#.#.#.#...#...#...#.....#.#...#.#.......#.....#...#.#.#.#.....#
#.#.#.#############.#.###.#.#.#.###.###.#.#.#.#.#######.#.#.#####.###.###.###.#.#.#.#.#.#.#.#.#.#####.#.#.###.#######.#.#######.#.#.#.#.###.#
#...#...............#.....#...#.....###...#...#.........#...#####.....###.....#...#...#...#...#.......#...###.........#.........#...#...###.#
###########################################################################################################################################.#`;

let grid = input.split("\n").map((str) => str.split(""));
const n = grid.length;
const m = grid[0].length;

let path = input
  .replaceAll("^", ".")
  .replaceAll(">", ".")
  .replaceAll("v", ".")
  .replaceAll("<", ".")
  .split("\n")
  .map((str) => str.split(""));

function getMaxSteps(x = 1, y = 0) {
  if (x === m - 2 && y === n - 1) return 0;
  if (grid[y]?.[x] === undefined || grid[y][x] === "#" || path[y][x] !== ".")
    return 0;
  path[y][x] = "O";
  let result = 1;
  switch (grid[y][x]) {
    case "^":
      result += getMaxSteps(x, y - 1);
      break;
    case ">":
      result += getMaxSteps(x + 1, y);
      break;
    case "v":
      result += getMaxSteps(x, y + 1);
      break;
    case "<":
      result += getMaxSteps(x - 1, y);
      break;
    case ".":
      result += Math.max(
        getMaxSteps(x, y - 1),
        getMaxSteps(x + 1, y),
        getMaxSteps(x, y + 1),
        getMaxSteps(x - 1, y)
      );
      break;
  }
  path[y][x] = ".";
  return result;
}

let output = getMaxSteps();
console.log(output);

// 2206
